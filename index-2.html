<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Aya's Study timer</title>
<link href="https://fonts.googleapis.com/css2?family=Pinyon+Script&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
<style>
  :root{
    --bg1:#ffe6f0; --bg2:#ffd6e8; --ribbon:#ffb6c1; --accent:#d65a8d; --ink:#5a3b4d; --card:#fff8fb;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    background: linear-gradient(135deg,var(--bg1),var(--bg2)); color:var(--ink);
    display:grid; place-items:center; padding:16px;
    background-size:cover; background-position:center; background-attachment:fixed;
  }
  .app{width:min(1100px,95vw); display:grid; grid-template-columns: 1.2fr .8fr; gap:18px}
  @media (max-width: 980px){ .app{grid-template-columns:1fr} }

  .card{background:var(--card); border:1px solid #ffd1e0; border-radius:24px; padding:22px; box-shadow:0 12px 30px rgba(214,90,141,.18); position:relative}
  h1{font-family:'Pinyon Script', cursive; font-size:56px; line-height:1; margin:0 0 4px; color:var(--accent); text-align:center}
  .subtitle{font-size:13px; text-align:center; opacity:.8; margin-bottom:10px}

  .ribbon{position:relative; margin:0 auto 12px; width:340px; height:54px; line-height:54px; text-align:center; background:var(--ribbon); color:#fff; font-weight:600; border-radius:10px; box-shadow:0 6px 14px rgba(0,0,0,.15)}
  .ribbon:before,.ribbon:after{content:""; position:absolute; top:0; border:27px solid var(--ribbon); z-index:-1}
  .ribbon:before{left:-54px; border-right-width:27px; border-left-color:transparent}
  .ribbon:after{right:-54px; border-left-width:27px; border-right-color:transparent}

  .timer-face{font-variant-numeric:tabular-nums; font-size:80px; font-weight:700; text-align:center; margin:8px 0 12px}
  .controls{display:flex; flex-wrap:wrap; gap:10px; justify-content:center; margin:.25rem 0 .5rem}
  .btn{background:var(--accent); color:#fff; border:0; padding:10px 18px; border-radius:999px; cursor:pointer; font-weight:600}
  .btn:hover{filter:brightness(.95)}
  .btn:disabled{opacity:.6; cursor:not-allowed}
  .row{display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:center; margin:.35rem 0}
  select, input[type=number], input[type=time]{padding:8px 10px; border:1px solid #f0a8c3; border-radius:12px; outline:none; min-width:140px}

  .uploader{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:8px}
  .uploader label{background:#ffe0ea; border:1px dashed #f0a8c3; padding:8px 12px; border-radius:12px; cursor:pointer}
  .uploader input{display:none}

  audio{width:100%; margin-top:10px}
  .hint{font-size:12px; opacity:.75; text-align:center; margin-top:6px}

  .col-title{font-weight:700; margin:2px 0 8px; color:var(--accent)}
  .todo-inputs{display:flex; gap:8px; flex-wrap:wrap}
  .todo-inputs input[type=text]{flex:1; min-width:200px; padding:10px; border:1px solid #f0a8c3; border-radius:12px}
  .todo-list{margin-top:10px; display:grid; gap:8px}
  .todo-item{display:flex; align-items:center; gap:10px; background:#fff; border:1px solid #ffd1e0; border-radius:12px; padding:8px 10px}
  .todo-item.done{opacity:.6; text-decoration:line-through}
  .todo-item small{opacity:.6}
  .icon-btn{background:#ffe0ea; color:var(--accent); border:0; padding:6px 10px; border-radius:10px; cursor:pointer}

  .calendar{margin-top:12px}
  .cal-header{display:flex; align-items:center; justify-content:space-between}
  .cal-grid{margin-top:8px; display:grid; grid-template-columns:repeat(7,1fr); gap:6px}
  .cal-cell{background:#fff; border:1px solid #ffd1e0; min-height:72px; border-radius:10px; padding:6px; font-size:12px; position:relative}
  .cal-cell .day{font-weight:700; opacity:.75}
  .cal-cell .dot{position:absolute; right:6px; bottom:6px; width:6px; height:6px; background:var(--accent); border-radius:50%}
  .cal-cell.today{outline:2px solid var(--accent)}
  .weekday{font-weight:700; text-align:center; opacity:.7}
  .cal-actions{display:flex; gap:8px}

  .bows{position:absolute; inset:0; pointer-events:none; opacity:.14}
  .bow{position:absolute; width:16px; height:16px; background:var(--accent); transform:rotate(45deg); border-radius:3px}
  .bow:before,.bow:after{content:""; position:absolute; width:70%; height:70%; background:#fff0f6; border-radius:50%}
  .bow:before{left:-30%; top:15%}
  .bow:after{right:-30%; top:15%}
  @keyframes floaty{from{transform:translateY(0) rotate(45deg)} to{transform:translateY(-30px) rotate(45deg)}}
</style>
</head>
<body>
  <div class="app" role="application" aria-label="Aya's Study timer">
    <section class="card" id="timerCard">
      <div class="bows" aria-hidden="true"></div>
      <h1>Aya's Study timer</h1>
      <div class="subtitle">Pink coquette vibes with ribbons & lofi ðŸŽ€</div>
      <div class="ribbon">Stay Focused ðŸŽ€</div>

      <div id="timeFace" class="timer-face" aria-live="polite" aria-atomic="true">25:00</div>

      <div class="controls">
        <button id="startBtn" class="btn" type="button">Start</button>
        <button id="pauseBtn" class="btn" type="button">Pause</button>
        <button id="resetBtn" class="btn" type="button">Reset</button>
      </div>

      <div class="row">
        <label for="mode">Mode:</label>
        <select id="mode">
          <option value="custom" selected>Custom</option>
          <option value="pomodoro">Pomodoro (25/5)</option>
        </select>
        <span id="customWrap">
          <label for="minutes">Minutes:</label>
          <input id="minutes" type="number" min="1" step="1" value="25" />
        </span>
      </div>

      <div class="uploader">
        <label>
          <input id="bgUpload" type="file" accept="image/*" />
          Upload Background Image
        </label>
        <label>
          <input id="audioUpload" type="file" accept="audio/*" />
          Upload Music (MP3, etc.)
        </label>
      </div>

      <audio id="lofi" controls loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_c48e1e9e03.mp3?filename=lofi-study-112191.mp3" type="audio/mpeg" />
        Your browser does not support the audio element.
      </audio>
      <div class="hint">Tip: Click Start to allow music â€” browsers often block autoplay without interaction.</div>
    </section>

    <section class="card" id="planner">
      <div class="col-title">Toâ€‘Do List & Reminders</div>
      <div class="todo-inputs">
        <input id="todoText" type="text" placeholder="New task (e.g., Read Chapter 3)" />
        <input id="todoDate" type="date" />
        <input id="todoTime" type="time" />
        <button id="addTodo" class="btn" type="button">Add</button>
      </div>
      <div id="todoList" class="todo-list" aria-live="polite"></div>

      <div class="calendar">
        <div class="cal-header">
          <div class="cal-actions">
            <button id="prevMonth" class="icon-btn" type="button">â—€</button>
            <button id="nextMonth" class="icon-btn" type="button">â–¶</button>
          </div>
          <div id="monthLabel" style="font-weight:700"></div>
          <button id="todayBtn" class="icon-btn" type="button">Today</button>
        </div>
        <div class="cal-grid" id="weekdayRow"></div>
        <div class="cal-grid" id="calendarGrid" aria-live="polite"></div>
      </div>
    </section>
  </div>

<script>
'use strict';
(() => {
  const $ = (sel, root=document) => root.querySelector(sel);
  const fmt = (n) => n.toString().padStart(2, '0');
  const fmtTime = (s) => \`\${fmt(Math.floor(s/60))}:\${fmt(s%60)}\`;

  const bows = document.querySelector('.bows');
  for(let i=0;i<18;i++){
    const b=document.createElement('div'); b.className='bow';
    b.style.left=(Math.random()*100)+'%'; b.style.bottom=(-8+Math.random()*100)+'%';
    b.style.animation=\`floaty \${8+Math.random()*6}s linear infinite\`; bows.appendChild(b);
  }

  const state = { running:false, id:null, remaining:25*60, mode:'custom', onBreak:false };
  const el = {
    face: $('#timeFace'), start: $('#startBtn'), pause: $('#pauseBtn'), reset: $('#resetBtn'),
    mode: $('#mode'), minutes: $('#minutes'), customWrap: $('#customWrap'),
    audio: $('#lofi'), audioUpload: $('#audioUpload'), bgUpload: $('#bgUpload')
  };

  function renderTimer(){
    el.face.textContent = fmtTime(state.remaining);
    el.customWrap.style.display = state.mode==='custom' ? 'inline-flex' : 'none';
    el.start.disabled = state.running; el.pause.disabled = !state.running;
  }
  function tick(){
    if(state.remaining>0){ state.remaining--; renderTimer(); return; }
    stop();
    if(state.mode==='pomodoro'){
      state.onBreak = !state.onBreak;
      state.remaining = state.onBreak ? 5*60 : 25*60;
      try{ alert(state.onBreak? 'Break time! 5 minutes ðŸŽ€' : 'Back to study! 25 minutes ðŸŽ€'); }catch(_){}
      start();
    }
  }
  function start(){ if(state.running) return; state.running=true; try{ el.audio.play().catch(()=>{});}catch(_){ } state.id=setInterval(tick,1000); renderTimer(); }
  function stop(){ if(state.id) clearInterval(state.id); state.id=null; state.running=false; renderTimer(); }
  function reset(){ stop(); state.remaining = (state.mode==='pomodoro') ? 25*60 : Math.max(1, parseInt(el.minutes.value||'25',10))*60; state.onBreak=false; renderTimer(); }
  function setMode(v){ state.mode = v ?? el.mode.value; state.onBreak=false; state.remaining = (state.mode==='pomodoro') ? 25*60 : Math.max(1, parseInt(el.minutes.value||'25',10))*60; renderTimer(); }

  el.start.addEventListener('click', start);
  el.pause.addEventListener('click', stop);
  el.reset.addEventListener('click', reset);
  el.mode.addEventListener('change', () => setMode());
  el.minutes.addEventListener('change', () => { if(state.mode==='custom'){ state.remaining = Math.max(1, parseInt(el.minutes.value||'25',10))*60; renderTimer(); }});

  el.audioUpload.addEventListener('change', (e)=>{
    const f=e.target.files?.[0]; if(!f) return; const url=URL.createObjectURL(f);
    el.audio.src=url; el.audio.play().catch(()=>{});
  });
  el.bgUpload.addEventListener('change', (e)=>{
    const f=e.target.files?.[0]; if(!f) return; const url=URL.createObjectURL(f);
    document.body.style.backgroundImage=\`url('\${url}')\`;
    document.body.style.backgroundSize='cover'; document.body.style.backgroundPosition='center';
  });

  const todoEl = {
    text: $('#todoText'), date: $('#todoDate'), time: $('#todoTime'), add: $('#addTodo'), list: $('#todoList')
  };
  const storage = {
    get(k, def){ try{ return JSON.parse(localStorage.getItem(k)) ?? def; }catch(_){ return def; } },
    set(k, v){ localStorage.setItem(k, JSON.stringify(v)); }
  };
  let todos = storage.get('aya.todos', []);

  function saveTodos(){ storage.set('aya.todos', todos); }
  function renderTodos(){
    todoEl.list.innerHTML='';
    if(!todos.length){ const empty=document.createElement('div'); empty.style.opacity=.7; empty.textContent='No tasks yet â€” add one!'; todoEl.list.appendChild(empty); return; }
    todos.sort((a,b)=> (a.date||'')+(a.time||'') > (b.date||'')+(b.time||'') ? 1 : -1);
    for(const t of todos){
      const row=document.createElement('div'); row.className='todo-item'+(t.done?' done':'');
      const cb=document.createElement('input'); cb.type='checkbox'; cb.checked=!!t.done; cb.addEventListener('change',()=>{t.done=cb.checked; saveTodos(); renderTodos(); renderCalendar();});
      const text=document.createElement('div'); text.style.flex='1'; text.innerHTML = \`<strong>\${t.text}</strong>\` + (t.date? \` <small>â€¢ \${t.date}\${t.time?(' '+t.time):''}</small>\`:'');
      const del=document.createElement('button'); del.className='icon-btn'; del.textContent='Delete'; del.addEventListener('click',()=>{todos=todos.filter(x=>x.id!==t.id); saveTodos(); renderTodos(); renderCalendar();});
      row.append(cb,text,del); todoEl.list.appendChild(row);
    }
  }
  function addTodo(){
    const text = (todoEl.text.value||'').trim(); if(!text) return todoEl.text.focus();
    const id = Date.now()+Math.random().toString(16).slice(2);
    const date = todoEl.date.value||''; const time = todoEl.time.value||'';
    const item = {id,text,date,time,done:false}; todos.push(item); saveTodos(); renderTodos(); renderCalendar(); scheduleReminder(item); todoEl.text.value='';
  }
  todoEl.add.addEventListener('click', addTodo);
  todoEl.text.addEventListener('keydown', (e)=>{ if(e.key==='Enter') addTodo(); });

  function scheduleReminder(item){
    if(!item.date || !item.time) return;
    const when = new Date(item.date+ 'T' + item.time);
    const ms = when.getTime() - Date.now();
    if(ms<=0) return;
    setTimeout(()=>{ if(!item.done) alert(\`Reminder: \${item.text} (\${item.date} \${item.time})\`); }, Math.min(ms, 2147483647));
  }
  for(const t of todos) scheduleReminder(t);

  const cal = { grid: $('#calendarGrid'), label: $('#monthLabel'), weekdayRow: $('#weekdayRow'), prev: $('#prevMonth'), next: $('#nextMonth'), today: $('#todayBtn') };
  const weekdays=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  weekdays.forEach(d=>{ const c=document.createElement('div'); c.className='weekday'; c.textContent=d; cal.weekdayRow.appendChild(c); });
  let view = new Date(); view.setDate(1);

  function renderCalendar(){
    const year=view.getFullYear(), month=view.getMonth();
    cal.label.textContent = view.toLocaleString(undefined,{month:'long', year:'numeric'});
    cal.grid.innerHTML='';
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month+1, 0).getDate();

    for(let i=0;i<firstDay;i++){ const cell=document.createElement('div'); cal.grid.appendChild(cell); }

    const today = new Date(); const todayKey = \`\${today.getFullYear()}-\${fmt(today.getMonth()+1)}-\${fmt(today.getDate())}\`;
    for(let d=1; d<=daysInMonth; d++){
      const cell=document.createElement('div'); cell.className='cal-cell';
      const day=document.createElement('div'); day.className='day'; day.textContent=d; cell.appendChild(day);
      const key=\`\${year}-\${fmt(month+1)}-\${fmt(d)}\`;
      if(key===todayKey) cell.classList.add('today');
      const has = todos.some(t => t.date===key && !t.done);
      if(has){ const dot=document.createElement('div'); dot.className='dot'; cell.appendChild(dot); }
      cell.addEventListener('click',()=>{ document.getElementById('todoDate').value = key; document.getElementById('todoText').focus(); });
      cal.grid.appendChild(cell);
    }
  }
  cal.prev.addEventListener('click',()=>{ view.setMonth(view.getMonth()-1); renderCalendar(); });
  cal.next.addEventListener('click',()=>{ view.setMonth(view.getMonth()+1); renderCalendar(); });
  cal.today.addEventListener('click',()=>{ view=new Date(); view.setDate(1); renderCalendar(); });

  renderTimer(); renderTodos(); renderCalendar();
})();
</script>
</body>
</html>
